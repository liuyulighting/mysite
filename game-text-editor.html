<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆä»ªè¡¨æ¿æ–‡æœ¬ç¼–è¾‘å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
        }

        .editor-layout {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .language-panel {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .panel-header {
            background: #3498db;
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-header.zh { background: #e74c3c; }
        .panel-header.en { background: #3498db; }
        .panel-header.ja { background: #9b59b6; }

        .panel-content {
            padding: 20px;
            max-height: 700px;
            overflow-y: auto;
        }

        .text-section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }

        .text-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .text-item {
            margin-bottom: 15px;
        }

        .text-item:last-child {
            margin-bottom: 0;
        }

        .text-label {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 5px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .text-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .text-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .text-input.textarea {
            min-height: 80px;
            resize: vertical;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .status {
            padding: 10px 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .preview {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .preview h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .preview-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }

        .section-icon {
            font-size: 18px;
        }

        .key-path {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: #6c757d;
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .editor-layout {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ® æ¸¸æˆä»ªè¡¨æ¿æ–‡æœ¬ç¼–è¾‘å™¨</h1>
            <p>ä¸“é—¨ç”¨äºç®¡ç†æ¸¸æˆä»ªè¡¨æ¿ç•Œé¢ä¸­çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ï¼Œæ”¯æŒå¤šè¯­è¨€ç¼–è¾‘</p>
        </div>

        <div id="status"></div>

        <div class="editor-layout" id="editorLayout">
            <!-- ç¼–è¾‘å™¨é¢æ¿å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="saveAll()">ğŸ’¾ ä¿å­˜æ‰€æœ‰æ–‡ä»¶</button>
            <button class="btn btn-success" onclick="addNewText()">â• æ·»åŠ æ–°æ–‡æœ¬</button>
            <button class="btn btn-warning" onclick="validateJSON()">âœ… éªŒè¯JSON</button>
            <button class="btn btn-secondary" onclick="resetChanges()">ğŸ”„ é‡ç½®æ›´æ”¹</button>
            <button class="btn btn-secondary" onclick="showPreview()">ğŸ‘ï¸ é¢„è§ˆJSON</button>
        </div>

        <div class="preview" id="preview" style="display: none;">
            <h3>ğŸ“‹ JSON é¢„è§ˆ</h3>
            <div class="preview-content" id="previewContent"></div>
        </div>
    </div>

    <script>
        let currentData = {
            zh: {},
            en: {},
            ja: {}
        };
        let originalData = {};

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadGameDashboardData();
        });

        // åŠ è½½æ¸¸æˆä»ªè¡¨æ¿æ•°æ®
        async function loadGameDashboardData() {
            showStatus('æ­£åœ¨åŠ è½½æ¸¸æˆä»ªè¡¨æ¿æ•°æ®...', 'info');
            
            try {
                // ä»profile.jsonåŠ è½½æ•°æ®
                const response = await fetch('data/profile.json');
                if (response.ok) {
                    const profileData = await response.json();
                    currentData = convertProfileToGameText(profileData);
                } else {
                    // å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®
                    currentData = getDefaultGameText();
                }
                
                originalData = JSON.parse(JSON.stringify(currentData));
                renderEditor();
                showStatus('æ¸¸æˆä»ªè¡¨æ¿æ•°æ®åŠ è½½æˆåŠŸï¼', 'success');
            } catch (error) {
                showStatus('åŠ è½½æ•°æ®å¤±è´¥ï¼š' + error.message, 'error');
                // ä½¿ç”¨é»˜è®¤æ•°æ®
                currentData = getDefaultGameText();
                originalData = JSON.parse(JSON.stringify(currentData));
                renderEditor();
            }
        }

        // å°†profileæ•°æ®è½¬æ¢ä¸ºæ¸¸æˆæ–‡æœ¬æ ¼å¼
        function convertProfileToGameText(profileData) {
            const result = { zh: {}, en: {}, ja: {} };
            
            // åŸºæœ¬ä¿¡æ¯
            result.zh.profile = {
                name: profileData.profile?.nameZh || profileData.profile?.name || "åˆ˜ç¦¹",
                title: profileData.profile?.titleZh || profileData.profile?.title || "äº§å“ç»ç†",
                location: profileData.profile?.locationZh || profileData.profile?.location || "ä¸­å›½å—äº¬",
                email: profileData.profile?.email || "liuyulighting@gmail.com",
                phone: profileData.profile?.phone || "+86 18069860189"
            };
            
            result.en.profile = {
                name: profileData.profile?.name || "Yu Liu",
                title: profileData.profile?.title || "Product Manager",
                location: profileData.profile?.location || "Nanjing, China",
                email: profileData.profile?.email || "liuyulighting@gmail.com",
                phone: profileData.profile?.phone || "+86 18069860189"
            };
            
            result.ja.profile = {
                name: profileData.profile?.name || "Yu Liu",
                title: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼",
                location: "ä¸­å›½ å—äº¬",
                email: profileData.profile?.email || "liuyulighting@gmail.com",
                phone: profileData.profile?.phone || "+86 18069860189"
            };

            // å¡å¸¦ä¿¡æ¯
            result.zh.cartridges = {
                d5: "D5 æ¸²æŸ“å™¨",
                kujiale: "é…·å®¶ä¹",
                projects: "ä¸ªäººé¡¹ç›®"
            };
            
            result.en.cartridges = {
                d5: "D5 Render",
                kujiale: "Kujiale",
                projects: "Side Projects"
            };
            
            result.ja.cartridges = {
                d5: "D5 ãƒ¬ãƒ³ãƒ€ãƒ¼",
                kujiale: "ã‚¯ãƒ¼ã‚¸ãƒ£ãƒ¬",
                projects: "ã‚µã‚¤ãƒ‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ"
            };

            // æ ‡ç­¾é¡µ
            result.zh.tabs = {
                skills: "æŠ€èƒ½",
                achievements: "æˆå°±",
                education: "æ•™è‚²"
            };
            
            result.en.tabs = {
                skills: "Skills",
                achievements: "Achievements",
                education: "Education"
            };
            
            result.ja.tabs = {
                skills: "ã‚¹ã‚­ãƒ«",
                achievements: "å®Ÿç¸¾",
                education: "æ•™è‚²"
            };

            // é¡¹ç›®è½®æ’­
            result.zh.projects = {
                d5Title: "D5 æ¸²æŸ“å™¨å›¢é˜Ÿç‰ˆ",
                d5Desc: "å…¨çƒé¢†å…ˆçš„å³æ—¶æ¸²æŸ“å™¨ B ç«¯ç‰ˆæœ¬ï¼ŒARR è¶… 1500 ä¸‡",
                kujialeTitle: "å‰åç«¯ä¸€ä½“å¯¹æ¥ç”Ÿäº§æ–¹æ¡ˆ",
                kujialeDesc: "é—¨åº—è®¢å•ç›´è¿å·¥å‚å®¡æ ¸ä¸ç”Ÿäº§ï¼Œæ”¯æ’‘ 100 äº¿èµ„äº§æµè½¬",
                officeTitle: "å…¬è£…å‚æ•°åŒ–è®¾è®¡å·¥å…·",
                officeDesc: "å‚æ•°åŒ–è£…é…å¼åŠå…¬å®¶å…·è®¾è®¡ï¼ŒæœåŠ¡éœ‡æ—¦/åœ£å¥¥ç­‰å“ç‰Œ",
                diverseshotTitle: "DiverseShot AI",
                diverseshotDesc: "å°†è§†é¢‘è½¬æ¢ä¸º 3D æ–‡ä»¶çš„ AI å®¢æˆ·ç«¯ï¼Œç®€å•æ˜“ç”¨"
            };
            
            result.en.projects = {
                d5Title: "D5 Render Team Edition",
                d5Desc: "Leading real-time renderer B2B version with ARR over 15M RMB",
                kujialeTitle: "End-to-End Production Solution",
                kujialeDesc: "Store orders directly connect to factory review and production, supporting 10B asset flow",
                officeTitle: "Parametric Office Design Tool",
                officeDesc: "Parametric modular office furniture design, serving Aurora/Sunon brands",
                diverseshotTitle: "DiverseShot AI",
                diverseshotDesc: "AI client that converts videos to 3D files, simple and easy to use"
            };
            
            result.ja.projects = {
                d5Title: "D5 ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ãƒ ç‰ˆ",
                d5Desc: "ä¸–ç•Œãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼B2Bç‰ˆã€ARR 1500ä¸‡è¶…",
                kujialeTitle: "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¸€ä½“ç”Ÿç”£ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³",
                kujialeDesc: "åº—èˆ—æ³¨æ–‡ãŒå·¥å ´å¯©æŸ»ãƒ»ç”Ÿç”£ã«ç›´æ¥æ¥ç¶šã€100å„„è³‡ç”£æµè»¢ã‚’ã‚µãƒãƒ¼ãƒˆ",
                officeTitle: "ã‚ªãƒ•ã‚£ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«",
                officeDesc: "ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯çµ„ç«‹å¼ã‚ªãƒ•ã‚£ã‚¹å®¶å…·ãƒ‡ã‚¶ã‚¤ãƒ³ã€éœ‡æ—¦/åœ£å¥¥ãƒ–ãƒ©ãƒ³ãƒ‰ã«ã‚µãƒ¼ãƒ“ã‚¹",
                diverseshotTitle: "DiverseShot AI",
                diverseshotDesc: "å‹•ç”»ã‚’3Dãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã™ã‚‹AIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ã‚·ãƒ³ãƒ—ãƒ«ã§ä½¿ã„ã‚„ã™ã„"
            };

            // æŒ‰é’®å’Œç•Œé¢æ–‡æœ¬
            result.zh.ui = {
                start: "START",
                exit: "EXIT",
                welcome: "æ¬¢è¿æ¥åˆ°æˆ‘çš„ä½œå“é›†",
                welcomeDesc: "ç‚¹å‡» START æŒ‰é’®å¼€å§‹æ¢ç´¢æˆ‘çš„ä½œå“",
                cartridge: "å¡å¸¦",
                level: "å…³å¡",
                cards: "å¡ç‰‡"
            };
            
            result.en.ui = {
                start: "START",
                exit: "EXIT",
                welcome: "Welcome to My Portfolio",
                welcomeDesc: "Click START button to explore my works",
                cartridge: "Cartridge",
                level: "Level",
                cards: "Cards"
            };
            
            result.ja.ui = {
                start: "ã‚¹ã‚¿ãƒ¼ãƒˆ",
                exit: "çµ‚äº†",
                welcome: "ç§ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¸ã‚ˆã†ã“ã",
                welcomeDesc: "ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç§ã®ä½œå“ã‚’æ¢ç´¢ã—ã¦ãã ã•ã„",
                cartridge: "ã‚«ãƒ¼ãƒˆãƒªãƒƒã‚¸",
                level: "ãƒ¬ãƒ™ãƒ«",
                cards: "ã‚«ãƒ¼ãƒ‰"
            };

            return result;
        }

        // è·å–é»˜è®¤æ¸¸æˆæ–‡æœ¬
        function getDefaultGameText() {
            return {
                zh: {
                    profile: {
                        name: "åˆ˜ç¦¹",
                        title: "äº§å“ç»ç†",
                        location: "ä¸­å›½å—äº¬",
                        email: "liuyulighting@gmail.com",
                        phone: "+86 18069860189"
                    },
                    cartridges: {
                        d5: "D5 æ¸²æŸ“å™¨",
                        kujiale: "é…·å®¶ä¹",
                        projects: "ä¸ªäººé¡¹ç›®"
                    },
                    tabs: {
                        skills: "æŠ€èƒ½",
                        achievements: "æˆå°±",
                        education: "æ•™è‚²"
                    },
                    projects: {
                        d5Title: "D5 æ¸²æŸ“å™¨å›¢é˜Ÿç‰ˆ",
                        d5Desc: "å…¨çƒé¢†å…ˆçš„å³æ—¶æ¸²æŸ“å™¨ B ç«¯ç‰ˆæœ¬ï¼ŒARR è¶… 1500 ä¸‡",
                        kujialeTitle: "å‰åç«¯ä¸€ä½“å¯¹æ¥ç”Ÿäº§æ–¹æ¡ˆ",
                        kujialeDesc: "é—¨åº—è®¢å•ç›´è¿å·¥å‚å®¡æ ¸ä¸ç”Ÿäº§ï¼Œæ”¯æ’‘ 100 äº¿èµ„äº§æµè½¬",
                        officeTitle: "å…¬è£…å‚æ•°åŒ–è®¾è®¡å·¥å…·",
                        officeDesc: "å‚æ•°åŒ–è£…é…å¼åŠå…¬å®¶å…·è®¾è®¡ï¼ŒæœåŠ¡éœ‡æ—¦/åœ£å¥¥ç­‰å“ç‰Œ",
                        diverseshotTitle: "DiverseShot AI",
                        diverseshotDesc: "å°†è§†é¢‘è½¬æ¢ä¸º 3D æ–‡ä»¶çš„ AI å®¢æˆ·ç«¯ï¼Œç®€å•æ˜“ç”¨"
                    },
                    ui: {
                        start: "START",
                        exit: "EXIT",
                        welcome: "æ¬¢è¿æ¥åˆ°æˆ‘çš„ä½œå“é›†",
                        welcomeDesc: "ç‚¹å‡» START æŒ‰é’®å¼€å§‹æ¢ç´¢æˆ‘çš„ä½œå“",
                        cartridge: "å¡å¸¦",
                        level: "å…³å¡",
                        cards: "å¡ç‰‡"
                    }
                },
                en: {
                    profile: {
                        name: "Yu Liu",
                        title: "Product Manager",
                        location: "Nanjing, China",
                        email: "liuyulighting@gmail.com",
                        phone: "+86 18069860189"
                    },
                    cartridges: {
                        d5: "D5 Render",
                        kujiale: "Kujiale",
                        projects: "Side Projects"
                    },
                    tabs: {
                        skills: "Skills",
                        achievements: "Achievements",
                        education: "Education"
                    },
                    projects: {
                        d5Title: "D5 Render Team Edition",
                        d5Desc: "Leading real-time renderer B2B version with ARR over 15M RMB",
                        kujialeTitle: "End-to-End Production Solution",
                        kujialeDesc: "Store orders directly connect to factory review and production, supporting 10B asset flow",
                        officeTitle: "Parametric Office Design Tool",
                        officeDesc: "Parametric modular office furniture design, serving Aurora/Sunon brands",
                        diverseshotTitle: "DiverseShot AI",
                        diverseshotDesc: "AI client that converts videos to 3D files, simple and easy to use"
                    },
                    ui: {
                        start: "START",
                        exit: "EXIT",
                        welcome: "Welcome to My Portfolio",
                        welcomeDesc: "Click START button to explore my works",
                        cartridge: "Cartridge",
                        level: "Level",
                        cards: "Cards"
                    }
                },
                ja: {
                    profile: {
                        name: "Yu Liu",
                        title: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼",
                        location: "ä¸­å›½ å—äº¬",
                        email: "liuyulighting@gmail.com",
                        phone: "+86 18069860189"
                    },
                    cartridges: {
                        d5: "D5 ãƒ¬ãƒ³ãƒ€ãƒ¼",
                        kujiale: "ã‚¯ãƒ¼ã‚¸ãƒ£ãƒ¬",
                        projects: "ã‚µã‚¤ãƒ‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ"
                    },
                    tabs: {
                        skills: "ã‚¹ã‚­ãƒ«",
                        achievements: "å®Ÿç¸¾",
                        education: "æ•™è‚²"
                    },
                    projects: {
                        d5Title: "D5 ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ãƒ ç‰ˆ",
                        d5Desc: "ä¸–ç•Œãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼B2Bç‰ˆã€ARR 1500ä¸‡è¶…",
                        kujialeTitle: "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¸€ä½“ç”Ÿç”£ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³",
                        kujialeDesc: "åº—èˆ—æ³¨æ–‡ãŒå·¥å ´å¯©æŸ»ãƒ»ç”Ÿç”£ã«ç›´æ¥æ¥ç¶šã€100å„„è³‡ç”£æµè»¢ã‚’ã‚µãƒãƒ¼ãƒˆ",
                        officeTitle: "ã‚ªãƒ•ã‚£ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«",
                        officeDesc: "ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯çµ„ç«‹å¼ã‚ªãƒ•ã‚£ã‚¹å®¶å…·ãƒ‡ã‚¶ã‚¤ãƒ³ã€éœ‡æ—¦/åœ£å¥¥ãƒ–ãƒ©ãƒ³ãƒ‰ã«ã‚µãƒ¼ãƒ“ã‚¹",
                        diverseshotTitle: "DiverseShot AI",
                        diverseshotDesc: "å‹•ç”»ã‚’3Dãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã™ã‚‹AIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ã‚·ãƒ³ãƒ—ãƒ«ã§ä½¿ã„ã‚„ã™ã„"
                    },
                    ui: {
                        start: "ã‚¹ã‚¿ãƒ¼ãƒˆ",
                        exit: "çµ‚äº†",
                        welcome: "ç§ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¸ã‚ˆã†ã“ã",
                        welcomeDesc: "ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç§ã®ä½œå“ã‚’æ¢ç´¢ã—ã¦ãã ã•ã„",
                        cartridge: "ã‚«ãƒ¼ãƒˆãƒªãƒƒã‚¸",
                        level: "ãƒ¬ãƒ™ãƒ«",
                        cards: "ã‚«ãƒ¼ãƒ‰"
                    }
                }
            };
        }

        // æ¸²æŸ“ç¼–è¾‘å™¨
        function renderEditor() {
            const layout = document.getElementById('editorLayout');
            layout.innerHTML = '';
            
            const languages = [
                { code: 'zh', name: 'ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },
                { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
                { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' }
            ];
            
            languages.forEach(lang => {
                const panel = createLanguagePanel(lang);
                layout.appendChild(panel);
            });
        }

        // åˆ›å»ºè¯­è¨€é¢æ¿
        function createLanguagePanel(lang) {
            const panel = document.createElement('div');
            panel.className = 'language-panel';
            
            const header = document.createElement('div');
            header.className = `panel-header ${lang.code}`;
            header.innerHTML = `${lang.flag} ${lang.name}`;
            
            const content = document.createElement('div');
            content.className = 'panel-content';
            content.innerHTML = renderLanguageContent(lang.code);
            
            panel.appendChild(header);
            panel.appendChild(content);
            
            return panel;
        }

        // æ¸²æŸ“è¯­è¨€å†…å®¹
        function renderLanguageContent(langCode) {
            const data = currentData[langCode] || {};
            let html = '';
            
            // å®šä¹‰æ–‡æœ¬åˆ†ç»„å’Œå›¾æ ‡
            const sections = [
                { key: 'profile', name: 'ä¸ªäººä¿¡æ¯', icon: 'ğŸ‘¤' },
                { key: 'cartridges', name: 'æ¸¸æˆå¡å¸¦', icon: 'ğŸ®' },
                { key: 'tabs', name: 'æ ‡ç­¾é¡µ', icon: 'ğŸ“‘' },
                { key: 'projects', name: 'é¡¹ç›®è½®æ’­', icon: 'ğŸ¯' },
                { key: 'ui', name: 'ç•Œé¢æ–‡æœ¬', icon: 'ğŸ–¥ï¸' }
            ];
            
            sections.forEach(section => {
                if (data[section.key]) {
                    html += `<div class="text-section">
                        <h3><span class="section-icon">${section.icon}</span> ${section.name}</h3>`;
                    
                    Object.keys(data[section.key]).forEach(key => {
                        const value = data[section.key][key];
                        const inputId = `${langCode}_${section.key}_${key}`;
                        const keyPath = `${section.key}.${key}`;
                        
                        html += `<div class="text-item">
                            <div class="text-label">
                                <span class="key-path">${keyPath}</span>
                            </div>
                            <input type="text" 
                                   id="${inputId}" 
                                   class="text-input ${key.includes('Desc') ? 'textarea' : ''}" 
                                   value="${escapeHtml(value)}"
                                   onchange="updateText('${langCode}', '${section.key}', '${key}', this.value)">
                        </div>`;
                    });
                    
                    html += '</div>';
                }
            });
            
            return html;
        }

        // æ›´æ–°æ–‡æœ¬
        function updateText(langCode, section, key, value) {
            if (!currentData[langCode]) {
                currentData[langCode] = {};
            }
            if (!currentData[langCode][section]) {
                currentData[langCode][section] = {};
            }
            currentData[langCode][section][key] = value;
        }

        // ä¿å­˜æ‰€æœ‰æ–‡ä»¶
        async function saveAll() {
            showStatus('æ­£åœ¨ä¿å­˜æ–‡ä»¶...', 'info');
            
            try {
                // å°†æ¸¸æˆæ–‡æœ¬æ•°æ®è½¬æ¢å›profile.jsonæ ¼å¼
                const profileData = await convertGameTextToProfile(currentData);
                
                // å°è¯•é€šè¿‡APIä¿å­˜æ–‡ä»¶
                try {
                    const response = await fetch('http://localhost:8081/api/save', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(profileData)
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        showStatus('âœ… æ–‡ä»¶ä¿å­˜æˆåŠŸï¼', 'success');
                        originalData = JSON.parse(JSON.stringify(currentData));
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (apiError) {
                    // APIä¿å­˜å¤±è´¥ï¼Œæä¾›ä¸‹è½½é€‰é¡¹
                    console.warn('APIä¿å­˜å¤±è´¥ï¼Œæä¾›ä¸‹è½½é€‰é¡¹:', apiError);
                    downloadProfileJSON(profileData);
                    showStatus('âš ï¸ APIä¿å­˜å¤±è´¥ï¼Œå·²æä¾›ä¸‹è½½é€‰é¡¹', 'warning');
                }
                
            } catch (error) {
                showStatus('ä¿å­˜å¤±è´¥ï¼š' + error.message, 'error');
            }
        }
        
        // ä¸‹è½½profile.jsonæ–‡ä»¶
        function downloadProfileJSON(data) {
            const jsonString = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'profile.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus('ğŸ“¥ å·²æä¾›profile.jsonä¸‹è½½ï¼Œè¯·æ‰‹åŠ¨æ›¿æ¢data/profile.jsonæ–‡ä»¶', 'info');
        }

        // å°†æ¸¸æˆæ–‡æœ¬æ•°æ®è½¬æ¢å›profileæ ¼å¼
        function convertGameTextToProfile(gameTextData) {
            // é¦–å…ˆåŠ è½½åŸå§‹profile.jsonä»¥ä¿æŒå®Œæ•´ç»“æ„
            return new Promise((resolve, reject) => {
                fetch('data/profile.json')
                    .then(response => response.json())
                    .then(originalProfile => {
                        // æ›´æ–°profileéƒ¨åˆ†
                        if (gameTextData.zh && gameTextData.zh.profile) {
                            Object.keys(gameTextData.zh.profile).forEach(key => {
                                if (originalProfile.profile[key + 'Zh']) {
                                    originalProfile.profile[key + 'Zh'] = gameTextData.zh.profile[key];
                                }
                            });
                        }
                        if (gameTextData.en && gameTextData.en.profile) {
                            Object.keys(gameTextData.en.profile).forEach(key => {
                                if (originalProfile.profile[key]) {
                                    originalProfile.profile[key] = gameTextData.en.profile[key];
                                }
                            });
                        }
                        if (gameTextData.ja && gameTextData.ja.profile) {
                            Object.keys(gameTextData.ja.profile).forEach(key => {
                                if (originalProfile.profile[key + 'Ja']) {
                                    originalProfile.profile[key + 'Ja'] = gameTextData.ja.profile[key];
                                }
                            });
                        }
                        
                        // æ›´æ–°cartridgeséƒ¨åˆ†
                        if (gameTextData.zh && gameTextData.zh.cartridges) {
                            originalProfile.cartridges.forEach(cartridge => {
                                if (gameTextData.zh.cartridges[cartridge.id]) {
                                    cartridge.nameZh = gameTextData.zh.cartridges[cartridge.id];
                                }
                            });
                        }
                        if (gameTextData.en && gameTextData.en.cartridges) {
                            originalProfile.cartridges.forEach(cartridge => {
                                if (gameTextData.en.cartridges[cartridge.id]) {
                                    cartridge.name = gameTextData.en.cartridges[cartridge.id];
                                }
                            });
                        }
                        if (gameTextData.ja && gameTextData.ja.cartridges) {
                            originalProfile.cartridges.forEach(cartridge => {
                                if (gameTextData.ja.cartridges[cartridge.id]) {
                                    cartridge.nameJa = gameTextData.ja.cartridges[cartridge.id];
                                }
                            });
                        }
                        
                        // æ›´æ–°UIéƒ¨åˆ†
                        if (gameTextData.zh && gameTextData.zh.ui) {
                            if (!originalProfile.ui) originalProfile.ui = {};
                            Object.keys(gameTextData.zh.ui).forEach(key => {
                                if (!originalProfile.ui[key]) originalProfile.ui[key] = {};
                                originalProfile.ui[key].zh = gameTextData.zh.ui[key];
                            });
                        }
                        if (gameTextData.en && gameTextData.en.ui) {
                            if (!originalProfile.ui) originalProfile.ui = {};
                            Object.keys(gameTextData.en.ui).forEach(key => {
                                if (!originalProfile.ui[key]) originalProfile.ui[key] = {};
                                originalProfile.ui[key].en = gameTextData.en.ui[key];
                            });
                        }
                        if (gameTextData.ja && gameTextData.ja.ui) {
                            if (!originalProfile.ui) originalProfile.ui = {};
                            Object.keys(gameTextData.ja.ui).forEach(key => {
                                if (!originalProfile.ui[key]) originalProfile.ui[key] = {};
                                originalProfile.ui[key].ja = gameTextData.ja.ui[key];
                            });
                        }
                        
                        resolve(originalProfile);
                    })
                    .catch(error => {
                        console.error('åŠ è½½åŸå§‹profile.jsonå¤±è´¥:', error);
                        reject(error);
                    });
            });
        }

        // æ·»åŠ æ–°æ–‡æœ¬
        function addNewText() {
            const section = prompt('è¯·è¾“å…¥æ–°çš„åˆ†ç»„åç§°ï¼ˆå¦‚ï¼šprofile, cartridges, tabs, projects, uiï¼‰ï¼š');
            if (!section) return;
            
            const key = prompt('è¯·è¾“å…¥æ–°çš„é”®åï¼š');
            if (!key) return;
            
            const languages = ['zh', 'en', 'ja'];
            languages.forEach(lang => {
                const value = prompt(`è¯·è¾“å…¥${lang}çš„æ–‡æœ¬å†…å®¹ï¼š`);
                if (value) {
                    if (!currentData[lang]) {
                        currentData[lang] = {};
                    }
                    if (!currentData[lang][section]) {
                        currentData[lang][section] = {};
                    }
                    currentData[lang][section][key] = value;
                }
            });
            
            renderEditor();
            showStatus('æ–°æ–‡æœ¬æ·»åŠ æˆåŠŸï¼', 'success');
        }

        // éªŒè¯JSON
        function validateJSON() {
            const languages = ['zh', 'en', 'ja'];
            let isValid = true;
            let errors = [];
            
            languages.forEach(lang => {
                try {
                    JSON.stringify(currentData[lang]);
                } catch (error) {
                    isValid = false;
                    errors.push(`${lang}: ${error.message}`);
                }
            });
            
            if (isValid) {
                showStatus('âœ… JSONæ ¼å¼éªŒè¯é€šè¿‡ï¼', 'success');
            } else {
                showStatus('âŒ JSONæ ¼å¼é”™è¯¯ï¼š' + errors.join(', '), 'error');
            }
        }

        // é‡ç½®æ›´æ”¹
        function resetChanges() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ›´æ”¹å—ï¼Ÿ')) {
                currentData = JSON.parse(JSON.stringify(originalData));
                renderEditor();
                showStatus('æ›´æ”¹å·²é‡ç½®', 'info');
            }
        }

        // æ˜¾ç¤ºçŠ¶æ€
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            setTimeout(() => {
                status.innerHTML = '';
            }, 5000);
        }

        // è½¬ä¹‰HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // æ˜¾ç¤ºé¢„è§ˆ
        function showPreview() {
            const preview = document.getElementById('preview');
            const content = document.getElementById('previewContent');
            
            let previewText = '';
            Object.keys(currentData).forEach(lang => {
                previewText += `// ${lang} æ¸¸æˆæ–‡æœ¬æ•°æ®\n`;
                previewText += JSON.stringify(currentData[lang], null, 2);
                previewText += '\n\n';
            });
            
            content.textContent = previewText;
            preview.style.display = 'block';
        }
    </script>
</body>
</html>
